<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Routing with Gloo Function Gateway | Scott Cranton &mdash; Solo.io Customer Success </title>
    <meta property="og:title" content="Routing with Gloo Function Gateway | Scott Cranton &mdash; Solo.io Customer Success " />
    <meta name="twitter:title" content="Routing with Gloo Function Gateway | Scott Cranton &mdash; Solo.io Customer Success " />

    <meta name="description" content="Introduction to function level routing with Solo.io Gloo.">
    <meta name="description" property="og:description" content="Introduction to function level routing with Solo.io Gloo." />
    <meta name="twitter:description" content="Introduction to function level routing with Solo.io Gloo." />

    <meta name="twitter:card" content="summary_large_image" />
    
    <meta name="twitter:site" content="@scottcranton" />
    
    <meta property="og:url" content="https://scott.cranton.com/function-routing-with-gloo.html" />

    <meta property="og:image" content="" />
    <meta name="twitter:image" content="" />

    <meta name="author" content="Scott Cranton" />

    <meta name="copyright" content="Copyright by Scott Cranton. All Rights Reserved." />

    <style>
        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 300;
            src: local('Roboto Light'), local('Roboto-Light'), url(https://fonts.gstatic.com/s/roboto/v15/Hgo13k-tfSpn0qi1SFdUfVtXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 400;
            src: local('Roboto'), local('Roboto-Regular'), url(https://fonts.gstatic.com/s/roboto/v15/CWB0XYA8bzo0kSThX0UTuA.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 700;
            src: local('Roboto Bold'), local('Roboto-Bold'), url(https://fonts.gstatic.com/s/roboto/v15/d-6IYplOFocCacKzxwXSOFtXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 900;
            src: local('Roboto Black'), local('Roboto-Black'), url(https://fonts.gstatic.com/s/roboto/v15/mnpfi9pxYH-Go5UiibESIltXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 300;
            src: local('Roboto Light Italic'), local('Roboto-LightItalic'), url(https://fonts.gstatic.com/s/roboto/v15/7m8l7TlFO-S3VkhHuR0at44P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 400;
            src: local('Roboto Italic'), local('Roboto-Italic'), url(https://fonts.gstatic.com/s/roboto/v15/vPcynSL0qHq_6dX7lKVByfesZW2xOQ-xsNqO47m55DA.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 700;
            src: local('Roboto Bold Italic'), local('Roboto-BoldItalic'), url(https://fonts.gstatic.com/s/roboto/v15/t6Nd4cfPRhZP44Q5QAjcC44P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 900;
            src: local('Roboto Black Italic'), local('Roboto-BlackItalic'), url(https://fonts.gstatic.com/s/roboto/v15/bmC0pGMXrhphrZJmniIZpY4P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }
    </style>
    
    <link href="/favicon.ico" rel="shortcut icon" type="image/x-icon" />
    
    <link rel="stylesheet" href="https://scott.cranton.com/assets/css/main.css">

    <link rel="canonical" href="https://scott.cranton.com/function-routing-with-gloo.html">

    <link rel="alternate" type="application/rss+xml" title="Scott Cranton" href="https://scott.cranton.com/feed.xml">
</head>

    <body>
        <div class="wrapper">
            <aside class="user-profile fixed" role="complementary">
    <div class="burger">
        <input class="trigger hidden" id="toggleBurger" type="checkbox" />
        <label for="toggleBurger">
            <span>Navigation</span>
        </label>
    </div>

    <div class="compact-header">
        <a class="avatar" href="https://scott.cranton.com"><img alt="Avatar" src="/scottcranton.png" /></a>
        <div class="my-info">
            <strong class="my-name">Scott Cranton</strong>
            <span class="my-job-title">Solo.io Customer Success</span>
        </div>
    </div>

    
        
        <div class="mainmenu">
            <a href="https://scott.cranton.com" >Home</a>
            
                
            
                
            
                
            
                
                    <a href="https://scott.cranton.com/archive/" >Archive</a>
                
            
                
                    <a href="https://scott.cranton.com/publications/" >Publications</a>
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
        </div>
        
    

    <p class="about-me">I lead Customer Success at Solo.io. I enjoy hacking tech, and writing about it.</p>

    <ul class="socials">
        <li><a href="http://twitter.com/scottcranton"><svg title="twitter" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://scott.cranton.com/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li><li><a href="https://www.linkedin.com/in/scottcranton/"><svg title="linkedin" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://scott.cranton.com/assets/svg/social-icons.svg#linkedin-icon"></use></svg></a></li><li><a href="https://github.com/scranton"><svg title="github" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://scott.cranton.com/assets/svg/social-icons.svg#github-icon"></use></svg></a></li>

        

        
         <li><a href="https://scott.cranton.com/feed.xml"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://scott.cranton.com/assets/svg/social-icons.svg#rss-icon"></use></svg></a></li>
        
    </ul>
</aside>

            <main class="the-content" role="main">
                <div class="search" role="search">
    <div>
        <div class="show-results-count">0 Results</div>
        <div class="search-holder">
            <input type="text" id="search-input" placeholder="search for..." />
        </div>
    </div>
    <ul id="results-container" class="results-container"></ul>
</div>


                <article class="post single" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2019-02-19T09:26:47-05:00" itemprop="datePublished">19 Feb, 2019</time></li>
            
        </ul>
        <h2 itemprop="name headline">Routing with Gloo Function Gateway</h2>
    </header>

    <div class="post-content">
        <figure class="aligncenter">
    <img src="https://images.unsplash.com/photo-1495592822108-9e6261896da8?ixlib=rb-1.2.1&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;auto=format&amp;fit=crop&amp;w=2250&amp;q=80" />
    <figcaption>Photo by <a href="https://unsplash.com/@pietrozj" target="_blank">Pietro Jeng</a>.</figcaption>
</figure>

<p>This is the 1st post in my 3 part series on doing Canary Releases with <a href="https://solo.io">Solo.io</a> <a href="https://gloo.solo.io">Gloo</a>.</p>

<ul>
  <li>In part 1, <a href="/function-routing-with-gloo.html">Routing with Gloo Function Gateway</a>,
you learned how to setup <a href="https://gloo.solo.io">Gloo</a>, and using Gloo to setup some initial function level routing rules.</li>
  <li>In part 2, <a href="/canary-deployments-with-solo.html">Canary Deployments with Gloo Function Gateway</a>,
you learned how to setup a conditional routing rule that routed requests to the new version of our service only when
a request header was present with the correct value.</li>
  <li>In part 3, <a href="/canary-deployments-with-weighted-routes.html">Canary Deployments with Gloo Function Gateway using Weighted Destinations</a>,
we used weighted destinations to route a percentage of request traffic to individual upstream services.</li>
</ul>

<p>This post introduces you to how to use the open source <a href="https://solo.io">Solo.io</a> <a href="https://github.com/solo-io/gloo">Gloo</a>
project to help you to route traffic to your Kubernetes hosted services. <a href="https://medium.com/solo-io/announcing-gloo-the-function-gateway-3f0860ef6600">Gloo is a function gateway</a> that gives users a number of benefits including sophisticated
function level routing, and deep service discovery with introspection of OpenAPI (Swagger) definitions, gRPC reflection,
Lambda discovery and more. This post will start with a simple example of Gloo discovering and routing requests to a
service that exposes REST functions. Later posts will build on this initial example to do highlight ever more complex
scenarios.</p>

<h1 id="prerequisites">Prerequisites</h1>

<p>I’m assuming you’re already running a Kubernetes installation. I’m assuming you’re using <a href="https://kubernetes.io/docs/setup/minikube/">minikube</a>
for this post though any recent Kubernetes installation should work as long as you have <a href="https://kubernetes.io/docs/tasks/tools/install-kubectl/">kubectl</a>
setup and configured correctly for your Kubernetes installation.</p>

<h1 id="setup">Setup</h1>

<h2 id="setup-example-service">Setup example service</h2>

<p>All of the Kubernetes manifests are located at <a href="https://github.com/scranton/gloo-canary-example">https://github.com/scranton/gloo-canary-example</a>. I’d suggest you clone
that repo locally to make it easier to try these example yourself. All command examples assume your in the top level
director of that repo.</p>

<p>Let’s start by installing an example service that exposes 4 REST functions. This service is based on the
<a href="https://github.com/go-swagger/go-swagger/tree/master/examples/2.0/petstore">go-swagger petstore example</a>.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl apply <span class="nt">-f</span> petstore-v1.yaml
</code></pre></div></div>

<div class="github-sample-reference">
  <div class="author-info">
    <a href="https://github.com/scranton/gloo-canary-example/blob/master/petstore-v1.yaml">This Github Sample</a> is by <a href="https://github.com/scranton">scranton</a>
  </div>
  <div class="meta-info">
    petstore-v1.yaml <a href="https://github.com/scranton/gloo-canary-example/blob/master/petstore-v1.yaml">view</a> <a href="https://raw.githubusercontent.com/scranton/gloo-canary-example/master/petstore-v1.yaml">raw</a>
  </div>
</div>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="nn">---</span>
<span class="c1"># petstore-v1</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Service</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">petstore-v1</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">default</span>
  <span class="na">labels</span><span class="pi">:</span>
    <span class="na">app</span><span class="pi">:</span> <span class="s">petstore-v1</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">ClusterIP</span>
  <span class="na">ports</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">http</span>
    <span class="na">port</span><span class="pi">:</span> <span class="s">8080</span>
    <span class="na">targetPort</span><span class="pi">:</span> <span class="s">8080</span>
    <span class="na">protocol</span><span class="pi">:</span> <span class="s">TCP</span>
  <span class="na">selector</span><span class="pi">:</span>
    <span class="na">app</span><span class="pi">:</span> <span class="s">petstore-v1</span>
<span class="nn">---</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">apps/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Deployment</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">petstore-v1</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">default</span>
  <span class="na">labels</span><span class="pi">:</span>
    <span class="na">app</span><span class="pi">:</span> <span class="s">petstore-v1</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">replicas</span><span class="pi">:</span> <span class="s">1</span>
  <span class="na">selector</span><span class="pi">:</span>
    <span class="na">matchLabels</span><span class="pi">:</span>
      <span class="na">app</span><span class="pi">:</span> <span class="s">petstore-v1</span>
  <span class="na">template</span><span class="pi">:</span>
    <span class="na">metadata</span><span class="pi">:</span>
      <span class="na">labels</span><span class="pi">:</span>
        <span class="na">app</span><span class="pi">:</span> <span class="s">petstore-v1</span>
    <span class="na">spec</span><span class="pi">:</span>
      <span class="na">containers</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">petstore-v1</span>
        <span class="na">image</span><span class="pi">:</span> <span class="s">scottcranton/petstore:v1</span>
        <span class="na">ports</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">containerPort</span><span class="pi">:</span> <span class="s">8080</span></code></pre></figure>

<p>We’ve installing this service into the <code class="highlighter-rouge">default</code> namespace, so we can look there to see if it’s installed correctly.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl get all <span class="nt">--namespace</span> default
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NAME                              READY   STATUS    RESTARTS   AGE
pod/petstore-v1-986747fc8-6hn9p   1/1     Running   0          16s

NAME                  TYPE        CLUSTER-IP     EXTERNAL-IP   PORT(S)    AGE
service/kubernetes    ClusterIP   10.96.0.1      &lt;none&gt;        443/TCP    22h
service/petstore-v1   ClusterIP   10.110.99.86   &lt;none&gt;        8080/TCP   17s

NAME                          READY   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/petstore-v1   1/1     1            1           16s

NAME                                    DESIRED   CURRENT   READY   AGE
replicaset.apps/petstore-v1-986747fc8   1         1         1       16s
</code></pre></div></div>

<p>Let’s test our service to make sure it installed correctly. This service is setup to expose on port <code class="highlighter-rouge">8080</code>, and will
return the list of all pets for <code class="highlighter-rouge">GET</code> requests on the query path <code class="highlighter-rouge">/api/pets</code>. The easiest way to test is to
<code class="highlighter-rouge">port-forward</code> the service so we can access it locally. We’ll need the service name for the port forwarding. Make sure
the service name matches the ones from your system. This will forward port 8080 from the service running in your Kubernetes
installation to your local machine, i.e. <code class="highlighter-rouge">localhost:8080</code>.</p>

<p>Get the service names for your installation</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl get service <span class="nt">--namespace</span> default
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NAME          TYPE        CLUSTER-IP     EXTERNAL-IP   PORT<span class="o">(</span>S<span class="o">)</span>    AGE
kubernetes    ClusterIP   10.96.0.1      &lt;none&gt;        443/TCP    22h
petstore-v1   ClusterIP   10.110.99.86   &lt;none&gt;        8080/TCP   42s
</code></pre></div></div>

<p>Setup the port forwarding</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl port-forward service/petstore-v1 8080:8080
</code></pre></div></div>

<p>In a separate terminal, run the following. The petstore function should return 2 pets: Dog and Cat.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl localhost:8080/api/pets
</code></pre></div></div>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[{</span><span class="s2">"id"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"Dog"</span><span class="p">,</span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"available"</span><span class="p">},{</span><span class="s2">"id"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"Cat"</span><span class="p">,</span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"pending"</span><span class="p">}]</span><span class="w">
</span></code></pre></div></div>

<p>You can also get the Swagger spec as well.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl localhost:8080/swagger.json
</code></pre></div></div>

<p>You can kill all the port forwards. Now we’ll setup Gloo…</p>

<h2 id="setup-gloo">Setup Gloo</h2>

<p>Let’s setup the Gloo command line utility. Full instructions are at the <a href="https://gloo.solo.io/installation/">Gloo doc site</a>.
Here are the quick setup instructions.</p>

<p>Setup the <code class="highlighter-rouge">glooctl</code> command line tool. This makes installation, upgrade, and operations of Gloo easier. Full installation
instructions are located on the <a href="https://gloo.solo.io">https://gloo.solo.io</a> site.</p>

<p>If you’re a Mac or Linux Homebrew user, I’d recommend installing as follows.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew <span class="nb">install </span>glooctl
</code></pre></div></div>

<p>Now let’s install Gloo into your Kubernetes installation.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>glooctl <span class="nb">install </span>gateway
</code></pre></div></div>

<p>Pretty easy, eh? Let’s verify that its installed and running correctly. Gloo by default creates and installs into the
<code class="highlighter-rouge">gloo-system</code> namespace, so let’s look at everything running there.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl get all <span class="nt">--namespace</span> gloo-system
</code></pre></div></div>

<p>And the output should look something like the following.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NAME                                 READY   STATUS    RESTARTS   AGE
pod/discovery-66c865f9bc-h6v8f       1/1     Running   0          22h
pod/gateway-777cf4486c-8mzj5         1/1     Running   0          22h
pod/gateway-proxy-5f58774ccc-rcmdv   1/1     Running   0          22h
pod/gloo-5c6c4466f-ptc8v             1/1     Running   0          22h

NAME                    TYPE           CLUSTER-IP      EXTERNAL-IP   PORT(S)                      AGE
service/gateway-proxy   LoadBalancer   10.97.13.246    &lt;pending&gt;     80:31333/TCP,443:32470/TCP   22h
service/gloo            ClusterIP      10.104.80.219   &lt;none&gt;        9977/TCP                     22h

NAME                            READY   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/discovery       1/1     1            1           22h
deployment.apps/gateway         1/1     1            1           22h
deployment.apps/gateway-proxy   1/1     1            1           22h
deployment.apps/gloo            1/1     1            1           22h

NAME                                       DESIRED   CURRENT   READY   AGE
replicaset.apps/discovery-66c865f9bc       1         1         1       22h
replicaset.apps/gateway-777cf4486c         1         1         1       22h
replicaset.apps/gateway-proxy-5f58774ccc   1         1         1       22h
replicaset.apps/gloo-5c6c4466f             1         1         1       22h
</code></pre></div></div>

<h1 id="routing">Routing</h1>

<h2 id="upstreams">Upstreams</h2>

<p>Before we get into routing, let’s talk a little about the concept of <code class="highlighter-rouge">Upstreams</code>. Upstreams are the services that Gloo
has discovered automatically. Let’s look at the upstreams that Gloo has discovered in our Kubernetes cluster.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>glooctl get upstreams
</code></pre></div></div>

<p>You may see some different entries than what follows. It depends on your Kubernetes cluster, and what is running currently.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+-------------------------------+------------+----------+------------------------------+
|           UPSTREAM            |    TYPE    |  STATUS  |           DETAILS            |
+-------------------------------+------------+----------+------------------------------+
| default-kubernetes-443        | Kubernetes | Accepted | svc name:      kubernetes    |
|                               |            |          | svc namespace: default       |
|                               |            |          | port:          443           |
|                               |            |          |                              |
| default-petstore-v1-8080      | Kubernetes | Accepted | svc name:      petstore-v1   |
|                               |            |          | svc namespace: default       |
|                               |            |          | port:          8080          |
|                               |            |          | REST service:                |
|                               |            |          | functions:                   |
|                               |            |          | - addPet                     |
|                               |            |          | - deletePet                  |
|                               |            |          | - findPetById                |
|                               |            |          | - findPets                   |
|                               |            |          |                              |
| gloo-system-gateway-proxy-443 | Kubernetes | Accepted | svc name:      gateway-proxy |
|                               |            |          | svc namespace: gloo-system   |
|                               |            |          | port:          443           |
|                               |            |          |                              |
| gloo-system-gateway-proxy-80  | Kubernetes | Accepted | svc name:      gateway-proxy |
|                               |            |          | svc namespace: gloo-system   |
|                               |            |          | port:          80            |
|                               |            |          |                              |
| gloo-system-gloo-9977         | Kubernetes | Accepted | svc name:      gloo          |
|                               |            |          | svc namespace: gloo-system   |
|                               |            |          | port:          9977          |
|                               |            |          |                              |
| kube-system-kube-dns-53       | Kubernetes | Accepted | svc name:      kube-dns      |
|                               |            |          | svc namespace: kube-system   |
|                               |            |          | port:          53            |
|                               |            |          |                              |
+-------------------------------+------------+----------+------------------------------+
</code></pre></div></div>

<p>Notice that our petstore service <code class="highlighter-rouge">default-petstore-v1-8080</code> is different from the other upstreams in that its details is
listing 4 REST service functions: <code class="highlighter-rouge">addPet</code>, <code class="highlighter-rouge">deletePet</code>, <code class="highlighter-rouge">findPetByID</code>, and <code class="highlighter-rouge">findPets</code>. This is because Gloo can auto-detect
OpenAPI / Swagger definitions. This allows Gloo to route to individual functions versus what most traditional API
Gateways do in only letting you route only to host:port granular services. Let’s see that in action.</p>

<p>Let’s look a little closer at our petstore upstream. The <code class="highlighter-rouge">glooctl</code> command let’s us output the full details in yaml or
json.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>glooctl get upstream default-petstore-v1-8080 <span class="nt">--output</span> yaml
</code></pre></div></div>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">discoveryMetadata</span><span class="pi">:</span> <span class="pi">{}</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">annotations</span><span class="pi">:</span>
    <span class="s">kubectl.kubernetes.io/last-applied-configuration</span><span class="pi">:</span> <span class="pi">|</span>
      <span class="no">{"apiVersion":"v1","kind":"Service","metadata":{"annotations":{},"labels":{"app":"petstore-v1"},"name":"petstore-v1","namespace":"default"},"spec":{"ports":[{"name":"http","port":8080,"protocol":"TCP","targetPort":8080}],"selector":{"app":"petstore-v1"},"type":"ClusterIP"}}</span>
  <span class="na">labels</span><span class="pi">:</span>
    <span class="na">app</span><span class="pi">:</span> <span class="s">petstore-v1</span>
    <span class="na">discovered_by</span><span class="pi">:</span> <span class="s">kubernetesplugin</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">default-petstore-v1-8080</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">gloo-system</span>
  <span class="na">resourceVersion</span><span class="pi">:</span> <span class="s2">"</span><span class="s">20387"</span>
<span class="na">status</span><span class="pi">:</span>
  <span class="na">reportedBy</span><span class="pi">:</span> <span class="s">gloo</span>
  <span class="na">state</span><span class="pi">:</span> <span class="s">Accepted</span>
<span class="na">upstreamSpec</span><span class="pi">:</span>
  <span class="na">kube</span><span class="pi">:</span>
    <span class="na">selector</span><span class="pi">:</span>
      <span class="na">app</span><span class="pi">:</span> <span class="s">petstore-v1</span>
    <span class="na">serviceName</span><span class="pi">:</span> <span class="s">petstore-v1</span>
    <span class="na">serviceNamespace</span><span class="pi">:</span> <span class="s">default</span>
    <span class="na">servicePort</span><span class="pi">:</span> <span class="s">8080</span>
    <span class="na">serviceSpec</span><span class="pi">:</span>
      <span class="na">rest</span><span class="pi">:</span>
        <span class="na">swaggerInfo</span><span class="pi">:</span>
          <span class="na">url</span><span class="pi">:</span> <span class="s">http://petstore-v1.default.svc.cluster.local:8080/swagger.json</span>
        <span class="na">transformations</span><span class="pi">:</span>
          <span class="na">addPet</span><span class="pi">:</span>
            <span class="na">body</span><span class="pi">:</span>
              <span class="na">text</span><span class="pi">:</span> <span class="s1">'</span><span class="s">{"id":</span><span class="nv"> </span><span class="s">{{</span><span class="nv"> </span><span class="s">default(id,</span><span class="nv"> </span><span class="s">"")</span><span class="nv"> </span><span class="s">}},"name":</span><span class="nv"> </span><span class="s">"{{</span><span class="nv"> </span><span class="s">default(name,</span><span class="nv"> </span><span class="s">"")}}","tag":</span>
                <span class="s">"{{</span><span class="nv"> </span><span class="s">default(tag,</span><span class="nv"> </span><span class="s">"")}}"}'</span>
            <span class="na">headers</span><span class="pi">:</span>
              <span class="s">:method</span><span class="pi">:</span>
                <span class="na">text</span><span class="pi">:</span> <span class="s">POST</span>
              <span class="s">:path</span><span class="pi">:</span>
                <span class="na">text</span><span class="pi">:</span> <span class="s">/api/pets</span>
              <span class="na">content-type</span><span class="pi">:</span>
                <span class="na">text</span><span class="pi">:</span> <span class="s">application/json</span>
          <span class="na">deletePet</span><span class="pi">:</span>
            <span class="na">headers</span><span class="pi">:</span>
              <span class="s">:method</span><span class="pi">:</span>
                <span class="na">text</span><span class="pi">:</span> <span class="s">DELETE</span>
              <span class="s">:path</span><span class="pi">:</span>
                <span class="na">text</span><span class="pi">:</span> <span class="s">/api/pets/{{ default(id, "") }}</span>
              <span class="na">content-type</span><span class="pi">:</span>
                <span class="na">text</span><span class="pi">:</span> <span class="s">application/json</span>
          <span class="na">findPetById</span><span class="pi">:</span>
            <span class="na">body</span><span class="pi">:</span> <span class="pi">{}</span>
            <span class="na">headers</span><span class="pi">:</span>
              <span class="s">:method</span><span class="pi">:</span>
                <span class="na">text</span><span class="pi">:</span> <span class="s">GET</span>
              <span class="s">:path</span><span class="pi">:</span>
                <span class="na">text</span><span class="pi">:</span> <span class="s">/api/pets/{{ default(id, "") }}</span>
              <span class="na">content-length</span><span class="pi">:</span>
                <span class="na">text</span><span class="pi">:</span> <span class="s2">"</span><span class="s">0"</span>
              <span class="na">content-type</span><span class="pi">:</span> <span class="pi">{}</span>
              <span class="na">transfer-encoding</span><span class="pi">:</span> <span class="pi">{}</span>
          <span class="na">findPets</span><span class="pi">:</span>
            <span class="na">body</span><span class="pi">:</span> <span class="pi">{}</span>
            <span class="na">headers</span><span class="pi">:</span>
              <span class="s">:method</span><span class="pi">:</span>
                <span class="na">text</span><span class="pi">:</span> <span class="s">GET</span>
              <span class="s">:path</span><span class="pi">:</span>
                <span class="na">text</span><span class="pi">:</span> <span class="s">/api/pets?tags={{default(tags, "")}}&amp;limit={{default(limit,</span>
                  <span class="s">"")}}</span>
              <span class="na">content-length</span><span class="pi">:</span>
                <span class="na">text</span><span class="pi">:</span> <span class="s2">"</span><span class="s">0"</span>
              <span class="na">content-type</span><span class="pi">:</span> <span class="pi">{}</span>
              <span class="na">transfer-encoding</span><span class="pi">:</span> <span class="pi">{}</span></code></pre></figure>

<p>Here we see that the <code class="highlighter-rouge">findPets</code> REST function is looking for requests on <code class="highlighter-rouge">/api/pets</code>, and <code class="highlighter-rouge">findPetsById</code> is
looking for requests on <code class="highlighter-rouge">/api/pets/{id}</code> where <code class="highlighter-rouge">{id}</code> is the id number of the single pet who’s details are to be returned.</p>

<h3 id="basic-routing">Basic Routing</h3>

<p>Gloo acts like an (better) <a href="https://kubernetes.io/docs/concepts/services-networking/ingress/">Kubernetes Ingress</a>, which
means it can allow requests from external to the Kubernetes cluster to access services running inside the cluster. Gloo
uses a concept called <code class="highlighter-rouge">VirtualService</code> to setup routes to Kubernetes hosted services.</p>

<p>This post will show you how to configure Gloo using the command line tools, and I’ll explain a little of what’s happening
with each command. I’ll also include the YAML at the end of each step if you’d prefer to work in a purely declarative
fashion (versus imperative commands).</p>

<p>Setup <code class="highlighter-rouge">VirtualService</code>. This gives us a place to define a set of related routes. This won’t do much till we create
some routes in the next steps.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>glooctl create virtualservice <span class="nt">--name</span> coalmine
</code></pre></div></div>

<p>Here’s the YAML that will create the same resource as the <code class="highlighter-rouge">glooctl</code> command we just ran. Note that by default the
<code class="highlighter-rouge">glooctl</code> command creates resources in the <code class="highlighter-rouge">gloo-system</code> namespace.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">gateway.solo.io/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">VirtualService</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">coalmine</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">gloo-system</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">displayName</span><span class="pi">:</span> <span class="s">coalmine</span>
  <span class="na">virtualHost</span><span class="pi">:</span>
    <span class="na">domains</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s1">'</span><span class="s">*'</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">gloo-system.coalmine</span>
</code></pre></div></div>

<p>Create a route for all traffic to go to our service.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>glooctl add route <span class="se">\</span>
  <span class="nt">--name</span> coalmine <span class="se">\</span>
  <span class="nt">--path-prefix</span> /petstore <span class="se">\</span>
  <span class="nt">--dest-name</span> default-petstore-v1-8080 <span class="se">\</span>
  <span class="nt">--prefix-rewrite</span> /api/pets
</code></pre></div></div>

<p>This sets up a simple ingress route so that all requests going to the Gloo Proxy <code class="highlighter-rouge">/</code> URL are redirected to the
<code class="highlighter-rouge">default-petstore-v1-8080</code> service <code class="highlighter-rouge">/api/pets</code>. Let’s test it. To get the Gloo proxy host and port number (remember
that Gloo is acting like a Kubernetes Ingress), we need to call <code class="highlighter-rouge">glooctl proxy url</code>. Then let’s call the route path.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">PROXY_URL</span><span class="o">=</span><span class="k">$(</span>glooctl proxy url<span class="k">)</span>
curl <span class="k">${</span><span class="nv">PROXY_URL</span><span class="k">}</span>/petstore
</code></pre></div></div>

<p>And we should see the same results as when we called the port forwarded service.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[{</span><span class="s2">"id"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"Dog"</span><span class="p">,</span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"available"</span><span class="p">},{</span><span class="s2">"id"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"Cat"</span><span class="p">,</span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"pending"</span><span class="p">}]</span><span class="w">
</span></code></pre></div></div>

<p>Here’s the full YAML for the coal virtual service created so far.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">gateway.solo.io/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">VirtualService</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">coalmine</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">gloo-system</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">displayName</span><span class="pi">:</span> <span class="s">coalmine</span>
  <span class="na">virtualHost</span><span class="pi">:</span>
    <span class="na">domains</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s1">'</span><span class="s">*'</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">gloo-system.coalmine</span>
    <span class="na">routes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">matcher</span><span class="pi">:</span>
        <span class="na">prefix</span><span class="pi">:</span> <span class="s">/petstore</span>
      <span class="na">routeAction</span><span class="pi">:</span>
        <span class="na">single</span><span class="pi">:</span>
          <span class="na">upstream</span><span class="pi">:</span>
            <span class="na">name</span><span class="pi">:</span> <span class="s">default-petstore-v1-8080</span>
            <span class="na">namespace</span><span class="pi">:</span> <span class="s">gloo-system</span>
      <span class="na">routePlugins</span><span class="pi">:</span>
        <span class="na">prefixRewrite</span><span class="pi">:</span>
          <span class="na">prefixRewrite</span><span class="pi">:</span> <span class="s">/api/pets</span>
</code></pre></div></div>

<h2 id="function-routing">Function Routing</h2>

<p>Would it be better if we could just route to the named REST function versus having to know the specifics of the query
path (i.e. <code class="highlighter-rouge">/api/pets</code>) the service is expecting? Gloo can help us with that. Let’s setup a route to <code class="highlighter-rouge">findPets</code> REST
function.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>glooctl add route <span class="se">\</span>
   <span class="nt">--name</span> coalmine <span class="se">\</span>
   <span class="nt">--path-prefix</span> /findPets <span class="se">\</span>
   <span class="nt">--dest-name</span> default-petstore-v1-8080 <span class="se">\</span>
   <span class="nt">--rest-function-name</span> findPets
</code></pre></div></div>

<p>And test it. We should see the same results as the request to <code class="highlighter-rouge">/petstore</code> as both those examples were exercising the
<code class="highlighter-rouge">findPets</code> REST function in the petstore service. This also shows that Gloo allows you to create multiple routing rules
for the same REST functions, if you want.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="k">${</span><span class="nv">PROXY_URL</span><span class="k">}</span>/findPets
</code></pre></div></div>

<p>If we want to route to a function with parameters, we can do that too by telling Gloo how to find the <code class="highlighter-rouge">id</code> parameter.
In this case, it happens to be a path parameter, but it could come from other parts of the request.</p>

<p><strong>Note</strong>: We’re about to create a route with a <strong>different</strong> name <code class="highlighter-rouge">findPetWithId</code> than the function name <code class="highlighter-rouge">findPetById</code>
it is routing to. Gloo allows you to setup routing rules for any prefix path to any function name.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>glooctl add route <span class="se">\</span>
   <span class="nt">--name</span> coalmine <span class="se">\</span>
   <span class="nt">--path-prefix</span> /findPetWithId <span class="se">\</span>
   <span class="nt">--dest-name</span> default-petstore-v1-8080 <span class="se">\</span>
   <span class="nt">--rest-function-name</span> findPetById <span class="se">\</span>
   <span class="nt">--rest-parameters</span> <span class="s1">':path=/findPetWithId/{id}'</span>
</code></pre></div></div>

<p>Let’s look up the details for the pet with id 1</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="k">${</span><span class="nv">PROXY_URL</span><span class="k">}</span>/findPetWithId/1
</code></pre></div></div>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="s2">"id"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"Dog"</span><span class="p">,</span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"available"</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>And the pet with id 2</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="k">${</span><span class="nv">PROXY_URL</span><span class="k">}</span>/findPetWithId/2
</code></pre></div></div>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="s2">"id"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"Cat"</span><span class="p">,</span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"pending"</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Here’s the complete YAML you could apply to get the same virtual service setup that we just did. To recreate this
virtual service you could just <code class="highlighter-rouge">kubectl apply</code> the following YAML.</p>

<div class="github-sample-reference">
  <div class="author-info">
    <a href="https://github.com/scranton/gloo-canary-example/blob/master/coalmine-virtual-service-part-1.yaml">This Github Sample</a> is by <a href="https://github.com/scranton">scranton</a>
  </div>
  <div class="meta-info">
    coalmine-virtual-service-part-1.yaml <a href="https://github.com/scranton/gloo-canary-example/blob/master/coalmine-virtual-service-part-1.yaml">view</a> <a href="https://raw.githubusercontent.com/scranton/gloo-canary-example/master/coalmine-virtual-service-part-1.yaml">raw</a>
  </div>
</div>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">gateway.solo.io/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">VirtualService</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">coalmine</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">gloo-system</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">displayName</span><span class="pi">:</span> <span class="s">coalmine</span>
  <span class="na">virtualHost</span><span class="pi">:</span>
    <span class="na">domains</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s1">'</span><span class="s">*'</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">gloo-system.coalmine</span>
    <span class="na">routes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">matcher</span><span class="pi">:</span>
        <span class="na">prefix</span><span class="pi">:</span> <span class="s">/findPetWithId</span>
      <span class="na">routeAction</span><span class="pi">:</span>
        <span class="na">single</span><span class="pi">:</span>
          <span class="na">destinationSpec</span><span class="pi">:</span>
            <span class="na">rest</span><span class="pi">:</span>
              <span class="na">functionName</span><span class="pi">:</span> <span class="s">findPetById</span>
              <span class="na">parameters</span><span class="pi">:</span>
                <span class="na">headers</span><span class="pi">:</span>
                  <span class="s">:path</span><span class="pi">:</span> <span class="s">/findPetWithId/{id}</span>
          <span class="na">upstream</span><span class="pi">:</span>
            <span class="na">name</span><span class="pi">:</span> <span class="s">default-petstore-v1-8080</span>
            <span class="na">namespace</span><span class="pi">:</span> <span class="s">gloo-system</span>
    <span class="pi">-</span> <span class="na">matcher</span><span class="pi">:</span>
        <span class="na">prefix</span><span class="pi">:</span> <span class="s">/findPets</span>
      <span class="na">routeAction</span><span class="pi">:</span>
        <span class="na">single</span><span class="pi">:</span>
          <span class="na">destinationSpec</span><span class="pi">:</span>
            <span class="na">rest</span><span class="pi">:</span>
              <span class="na">functionName</span><span class="pi">:</span> <span class="s">findPets</span>
              <span class="na">parameters</span><span class="pi">:</span> <span class="pi">{}</span>
          <span class="na">upstream</span><span class="pi">:</span>
            <span class="na">name</span><span class="pi">:</span> <span class="s">default-petstore-v1-8080</span>
            <span class="na">namespace</span><span class="pi">:</span> <span class="s">gloo-system</span>
    <span class="pi">-</span> <span class="na">matcher</span><span class="pi">:</span>
        <span class="na">prefix</span><span class="pi">:</span> <span class="s">/petstore</span>
      <span class="na">routeAction</span><span class="pi">:</span>
        <span class="na">single</span><span class="pi">:</span>
          <span class="na">upstream</span><span class="pi">:</span>
            <span class="na">name</span><span class="pi">:</span> <span class="s">default-petstore-v1-8080</span>
            <span class="na">namespace</span><span class="pi">:</span> <span class="s">gloo-system</span>
      <span class="na">routePlugins</span><span class="pi">:</span>
        <span class="na">prefixRewrite</span><span class="pi">:</span>
          <span class="na">prefixRewrite</span><span class="pi">:</span> <span class="s">/api/pets</span></code></pre></figure>

<h1 id="summary">Summary</h1>

<p>This post is just the beginning of our function gateway journey with Gloo. Hopefully its given you a taste of some
more sophisticated function level routing options that are available to you. I’ll try to follow up with more posts on
even more options available to you.</p>

    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Routing with Gloo Function Gateway&p[summary]=Introduction to function level routing with Solo.io Gloo.&p[url]=https://scott.cranton.com/function-routing-with-gloo.html" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://scott.cranton.com/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=https://scott.cranton.com/function-routing-with-gloo.html&text=Introduction to function level routing with Solo.io Gloo.&hashtags=Gloo," rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://scott.cranton.com/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
                <li><a href="https://scott.cranton.com/tag/Gloo">Gloo</a></li>
                
            </ul>
        </div>
        
    </footer>
</article>


<aside class="comments" role="complementary">
    <div id="disqus_thread"></div>
    <script>
        var disqus_config = function () {
            this.page.url = 'https://scott.cranton.com/function-routing-with-gloo.html';
            this.page.identifier = '2/19/2019';
        };
        (function() {
            var d = document, s = d.createElement('script');

            s.src = '//scott-cranton-blog.disqus.com/embed.js';

            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>
</aside>

            </main>
        </div>

        <script src="https://scott.cranton.com/assets/js/jquery-1.12.2.min.js"></script>
<script src="https://scott.cranton.com/assets/js/backtotop.js"></script>
<script src="https://scott.cranton.com/assets/js/lunr.min.js"></script>
<script src="https://scott.cranton.com/assets/js/lunr-feed.js"></script>
<script src="https://scott.cranton.com/assets/js/jquery.fitvids.js"></script>
<script src="https://scott.cranton.com/assets/js/svg4everybody.min.js"></script>
<script src="https://scott.cranton.com/assets/js/scripts.js"></script>


    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-134627391-1', 'auto');
        ga('send', 'pageview');
    </script>

    </body>
</html>